!function(e) {
    function t() {
        return getComputedStyle(i)
    }
    function n(e) {
        return e && e.replace(/^[\s'"]|[\s'"]$/g, "")
    }
    var i = document.documentElement
      , o = i.attributes;
    e.checkMobile = e.checkMobile || {},
    e.checkMobile.css = e.checkMobile.css || {},
    e.checkMobile.css.isMobile = function() {
        return [o["data-mobile"].value, "attr(data-mobile)"].indexOf(n(t().content)) >= 0
    }
    ,
    e.checkMobile.css.isLandscape = function() {
        return /Mobi/i.test(navigator.userAgent) ? 90 === Math.abs(window.orientation) || screen.availHeight < screen.availWidth : [o["data-landscape"].value, "attr(data-landscape)"].indexOf(n(t().content)) >= 0
    }
}(peppers = peppers || {});
var peppers;
!function(e, t, n) {
    var i = t.userAgent || t.vendor || n.opera;
    e.checkMobile = e.checkMobile || {},
    e.checkMobile.isMobile = function() {
        return /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(i) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0, 4))
    }
    ,
    e.checkMobile.isMobileOrTablet = function() {
        return /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(i) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0, 4))
    }
}(peppers = peppers || {}, navigator, window);
var peppers;
!function(e, t) {
    function n() {
        var e = peppers.checkMobile.css.isMobile();
        i !== e && (i = e,
        o.trigger("check-mobile:change", i))
    }
    var i, o = e(t).on("resize", n);
    peppers.checkMobile = peppers.checkMobile || {},
    peppers.checkMobile.css = peppers.checkMobile.css || {},
    peppers.checkMobile.css.listen = function(e) {
        o.on("check-mobile:change", e),
        void 0 !== i && e(null, i)
    }
    ,
    n()
}(jQuery, window, peppers = peppers || {});
var peppers;
!function(e, t, n) {
    var i = $.Deferred()
      , o = [];
    e.ready = i.promise(),
    e.ready.addWait = function(e) {
        if (!e) {
            if (arguments.length > 0)
                return;
            var t = $.Deferred();
            e = t.promise()
        }
        return o.push(e),
        e.done(function() {
            o.splice(o.indexOf(e), 1),
            0 == o.length && i.resolve()
        }),
        t
    }
    ,
    e.navigateTo = function(t) {
        function i() {
            n.href = t
        }
        e.Transition.opened ? (e.Transition.fadeIn(),
        setTimeout(i, 800)) : i()
    }
}(kaspersky = kaspersky || {}, document, location);
var kaspersky;
!function(e, t) {
    function n(e, t) {
        switch (typeof e) {
        case "number":
        case "string":
        case "boolean":
            return e === t;
        default:
            var i, o = [];
            for (i in e)
                if (o.push(i),
                !n(e[i], t[i]))
                    return !1;
            for (i in t)
                if (o.indexOf(i) < 0)
                    return !1;
            return !0
        }
    }
    function i(e, n) {
        if (!n)
            return t.hash = e || "/";
        t.replace("#" + (e || "/"))
    }
    function o(e) {
        return (e || t.hash).replace(/^#?\/?|\/$/, "").split("/")
    }
    e.hash = {
        getHash: o,
        isEqual: n,
        setHash: i
    }
}(peppers = peppers || {}, window.location);
var peppers;
!function(e) {
    e.jQueryConstructor = function(e, t) {
        return function(n) {
            var i = arguments;
            return this.each(function() {
                var n = $(this)
                  , o = n.data(e);
                o || n.data(e, o = new t(n)),
                "function" == typeof o.init && o.init.apply(o, i)
            })
        }
    }
}(peppers = peppers || {});
var peppers;
!function(e, t) {
    e.formatNumber = function(e) {
        for (var t = [], n = ("" + e).replace(/\s/g, ""); n.length > 0; )
            t.unshift(n.substr(-3)),
            n = n.substr(0, n.length - 3);
        return t.join(" ")
    }
    ,
    t && t.registerHelper("formatNumber", e.formatNumber)
}(peppers = peppers || {}, window.Handlebars);
var peppers;
!function(e, t) {
    t(e).ready(function() {
        function n(e) {
            console.debug("onAccelerometer", e),
            l ? (d.beta = s(-(e.beta - l.beta) / 10, 1) * u,
            d.gamma = s((e.gamma - l.gamma) / 10, 1) * u) : (h.off("mousemove", i),
            l = {
                beta: e.beta,
                gamma: e.gamma
            })
        }
        function i(e) {
            var t = Math.ceil(p.width() / 2)
              , n = Math.ceil(p.height() / 2)
              , i = e.pageX - t
              , o = e.pageY - n;
            d.beta = o / n * u,
            d.gamma = -i / t * u
        }
        function o() {
            c.css({
                transform: "rotate3d(1, 0, 0, " + f.beta + "deg) rotate3d(0, 1, 0, " + f.gamma + "deg)"
            })
        }
        function a() {
            for (var e in f)
                f[e] += (d[e] - f[e]) * m[e]
        }
        function r() {
            requestAnimationFrame(r),
            v(),
            g(f)
        }
        function s(e, t) {
            return t = Math.abs(t),
            e < -t ? -t : e > t ? t : e
        }
        var c = t(".parallax__container");
        if (0 != c.length) {
            var l, u = 14, p = t(e.body), h = t(e.documentElement);
            h.mousemove(i),
            peppers.accelerometer.on("change", n);
            var d = {
                beta: 0,
                gamma: 0
            }
              , f = {
                beta: 0,
                gamma: 0
            }
              , m = {
                beta: .05,
                gamma: .05
            }
              , g = o
              , v = a;
            r()
        }
    })
}(document, jQuery),
function(e, t) {
    function n() {
        c && (c = !1,
        t.removeEventListener("deviceorientation", o, !0),
        t.removeEventListener("devicemotion", o, !0),
        t.removeEventListener("MozOrientation", o, !0))
    }
    function i() {
        c || (c = !0,
        t.DeviceOrientationEvent ? t.addEventListener("deviceorientation", o, !0) : t.DeviceMotionEvent ? t.addEventListener("devicemotion", o, !0) : t.addEventListener("MozOrientation", o, !0))
    }
    function o(e) {
        switch (e.type) {
        case "deviceorientation":
            a(e.beta, e.gamma);
            break;
        case "devicemotion":
            a(2 * e.acceleration.x, 2 * e.acceleration.y);
            break;
        case "MozOrientation":
            a(50 * orientation.x, 50 * orientation.y)
        }
    }
    function a(e, t) {
        console.debug(typeof e),
        (e || t) && r("change", {
            beta: e,
            gamma: t
        })
    }
    function r(e, t) {
        for (var n = 0; l[e] && n < l[e].length; n++)
            l[e][n](t)
    }
    function s(e, t) {
        return (l[e] = l[e] || []).indexOf(t)
    }
    var c, l = {};
    e.accelerometer = {
        on: function(e, t) {
            s(e, t) < 0 && "function" == typeof t && l[e].push(t),
            l[e].length > 0 && i()
        },
        off: function(e, t) {
            var i = s(e, t);
            i >= 0 && l[e].splice(i, 1),
            (l[e].length = 0) && n()
        }
    }
}(peppers = peppers || {}, window);
var peppers;
!function(e) {
    function t(t) {
        function n(t) {
            r.toggleClass("pep-placeholder__text_hidden", "keypress" == t.type || !!e(this).val())
        }
        function i() {
            var e = o();
            return t.data("placeholder", e),
            t.attr("placeholder", ""),
            e
        }
        function o() {
            return t.attr("placeholder") || t.data("placeholder")
        }
        var a, r;
        this.init = function(o) {
            this.destroy();
            var s = i();
            t.wrap("<div class='pep-placeholder'></div>"),
            r = e("<div class='pep-placeholder__text'>" + (e.isFunction(o) ? o(s) || "" : s) + "</div>").insertBefore(t).addClass(t.get(0).className),
            t.addClass("pep-placeholder__input"),
            a = t.parent(),
            t.on("keypress  keyup  change  input:empty", n)
        }
        ,
        this.destroy = function() {
            a && (a.after(t),
            a.remove(),
            a = void 0),
            t.removeClass("pep-placeholder__input");
            var e = o();
            t.data("placeholder", ""),
            t.attr("placeholder", e),
            t.off("keypress  keyup  change  input:empty", n)
        }
    }
    e.fn.pepPlaceholder = function(n) {
        this.each(function() {
            var i = e(this)
              , o = i.data("pepPlaceholder");
            o || i.data("pepPlaceholder", o = new t(i)),
            o.init(n)
        })
    }
}(jQuery),
function(e) {
    function t(e, t) {
        this.x = e,
        this.y = t
    }
    t.prototype.subtract = function(e) {
        return new t(this.x - e.x,this.y - e.y)
    }
    ,
    t.prototype.add = function(e) {
        return new t(this.x + e.x,this.y + e.y)
    }
    ,
    t.prototype.length = function() {
        return Math.sqrt(this.x * this.x + this.y * this.y)
    }
    ,
    t.prototype.distance = function(e) {
        return this.subtract(e).length()
    }
    ,
    t.prototype.toString = function() {
        return "[Point(" + this.x + ", " + this.y + ")]"
    }
    ,
    t.distance = function(e, t) {
        return t.subtract(e).length()
    }
    ,
    t.prototype.clone = function() {
        return new t(this.x,this.y)
    }
    ,
    e.Point = t
}(peppers = peppers || {});
var peppers;
!function(e) {
    function t(e) {
        var t = $.Deferred()
          , n = $("<img/>").addClass("image-preloader");
        return n.attr("crossOrigin", "Anonymous"),
        n.on("load", function() {
            t.resolve(n)
        }),
        n.on("error", function(e) {
            t.reject(e)
        }),
        n.attr("src", e),
        $(document.body).append(n),
        t.promise()
    }
    function n(e, t) {
        var n = $(e).width()
          , i = $(e).height();
        t = t || {},
        t.width = t.width || n,
        t.height = t.height || i;
        var o = Math.min(1, t.width / n, t.height / i);
        t.width = Math.round(n * o),
        t.height = Math.round(i * o);
        var a = document.createElement("canvas");
        a.width = t.width,
        a.height = t.height;
        var r = a.getContext("2d");
        return r.drawImage(e.get(0), 0, 0, n, i, 0, 0, t.width, t.height),
        {
            width: t.width,
            height: t.height,
            data: r.getImageData(0, 0, t.width, t.height).data
        }
    }
    e.load = t,
    e.getImageData = n
}(peppers = peppers || {});
var peppers;
!function(e) {
    e.trimText = function(e, t, n) {
        n = n || 1;
        var i = []
          , o = e.split(/\r?\n/g);
        if (t = Math.max(t, e.length / n),
        o.length > 1)
            for (var a = 0; a < o.length; a++)
                o.splice(a, 1, trimText(o[a], t));
        else
            for (o = e.split(" "); o.length > 0; ) {
                var r = []
                  , s = 0;
                do {
                    var c = o.shift();
                    s += c.length,
                    r.push(c)
                } while (o.length > 0 && s + .5 * o[0].length < t);o.length > 0 && r.length > 1 && ["a", "the", "is", "of"].indexOf(r[r.length - 1].toLowerCase()) >= 0 && o.unshift(r.pop()),
                i.push(r.join(" "))
            }
        return i
    }
}(kaspersky = kaspersky || {});
var kaspersky;
!function(e, t) {
    function n() {
        var e = $(t.body)
          , n = Math.max(e.width(), screen.width)
          , o = Math.max(e.height(), screen.height)
          , a = $(".transition-wrapper");
        0 == a.length && (a = $("<div class='transition-wrapper'>"),
        e.append(a));
        for (var r = n / 10 + 1, s = 100 / 86.55 * r + 1, c = [], l = {}, u = 0, p = 0, h = -s / 2; h < o + s / 2; h += .75 * s - 1) {
            p = 0;
            for (var d = -r / 2; d < n + r / 2; d += r - 1) {
                var f = $("<div class='transition-hexagon-bg'><div class='transition-hexagon'>");
                c.push(f),
                a.append(f);
                var m = u % 2 == 0;
                f.css({
                    width: r + "px",
                    height: s + "px",
                    left: d - (m ? r / 2 : 0) + "px",
                    top: h + "px"
                }),
                p++
            }
            u++
        }
        $("<div></div>").addClass("transition__preloader").appendTo(a),
        a.addClass("transition-wrapper_initialized"),
        this.opened = !1,
        this.fadeIn = function() {
            this.opened = !1,
            $.each(c, i(!0, l))
        }
        ,
        this.fadeOut = function() {
            this.opened = !0,
            $.each(c, i(!1, l)),
            a.addClass("transition-wrapper_fade-out")
        }
        ,
        this.getDelay = function() {
            return 800 + l.delay
        }
        ,
        this.fadeOut()
    }
    function i(e, t) {
        return t.delay = 0,
        function() {
            var n = $(this)
              , i = Math.round(30 * Math.random() * 20);
            t.delay = Math.max(t.delay, i),
            setTimeout(function() {
                n.toggleClass("transition-hexagon_a-out", !e).toggleClass("transition-hexagon_a-in", e)
            }, i)
        }
    }
    e.Transition = new n
}(kaspersky = kaspersky || {}, document);
var kaspersky;
!function(e) {
    function t() {
        function e() {
            r.css("height", $(this).outerHeight() + parseInt(r.css("paddingTop")) + parseInt(r.css("paddingBottom")))
        }
        var t = $(this).parent()
          , n = t.find(".checkbox-nth")
          , i = n.index(this)
          , o = t.find(".checkbox-nth-item");
        o.off("checkbox:change");
        var a = o.eq(i).on("checkbox:change", e)
          , r = t.find(".checkbox-nth-container");
        r.css({
            height: a.outerHeight() + parseInt(r.css("paddingTop")) + parseInt(r.css("paddingBottom"))
        }),
        setTimeout(function() {
            var e = t.find(".checkbox-nth-container");
            e.css({
                height: a.outerHeight() + parseInt(e.css("paddingTop")) + parseInt(e.css("paddingBottom"))
            })
        }, 50)
    }
    $(e.documentElement).on("change", ".checkbox-nth", t)
}(document),
function(e, t, n) {
    function i(e) {
        var t = e.find(".clip-path rect, .back-btn-svg__mask rect");
        t.attr({
            y: "50%",
            height: "0%"
        });
        var i = {
            height: 0
        };
        e.hover(function(e) {
            var a = o[e.type];
            n.to(i, a.duration, {
                height: a.tween.height,
                ease: a.tween.ease,
                onUpdate: function() {
                    t.attr({
                        y: 50 - .5 * i.height + "%",
                        height: i.height + "%"
                    })
                }
            })
        })
    }
    var o = {
        mouseenter: {
            duration: .4,
            tween: {
                ease: Sine.easeOut,
                height: 102
            }
        },
        mouseleave: {
            duration: .2,
            tween: {
                ease: Sine.easeIn,
                height: 0
            }
        }
    };
    e.fn.hexButton = t.jQueryConstructor("hexButton", i)
}(jQuery, peppers = peppers || {}, TweenLite);
var peppers;
!function(e, t) {
    function n() {
        clearInterval(c);
        var t = e(this).is(":checked");
        t || (c = setInterval(o, g),
        o()),
        i(t),
        e.cookie("muted", t ? 1 : 0, {
            path: "/",
            expires: 3650
        });
        var n = e(".sound").get(0);
        void 0 !== localStorage.sound_progress && (n.currentTime = parseFloat(localStorage.sound_progress)),
        n.ontimeupdate = function() {
            localStorage.sound_progress = n.currentTime
        }
    }
    function i(e) {
        e ? d.get(0).pause() : d.get(0).play()
    }
    function o() {
        for (var e = r(), t = 0; t < h.length; t++)
            h[t].css("height", 100 * e(t / (h.length - 1)) + "%")
    }
    function a(e, t) {
        return t ? t + e[0].toUpperCase() + e.substr(1) : e
    }
    function r() {
        for (var e = [], t = 1 + 6 * Math.random(), n = 2 * Math.random() * Math.PI; e.length < t; )
            e.push(s(n));
        return function(t) {
            for (var n = 0, i = 0; i < e.length; i++)
                n += e[i](t);
            return .5 + n / e.length * .5
        }
    }
    function s(e) {
        var t = 2 * Math.floor(1 + 3 * Math.random()) * Math.PI;
        return function(n) {
            return Math.sin(e + n * t)
        }
    }
    for (var c, l = e(".mute-btn_false"), u = l.find("label"), p = [1, 2, 3, 7, 18, 11, 25, 13, 26, 47, 26, 18, 25, 11, 18, 7, 3, 2, 1], h = [], d = e(".sound", top.document), f = 0; f < p.length; f++) {
        var m = e("<span></span>").addClass("mute-btn__line");
        h.push(m),
        m.appendTo(u).after(" ").css("height", p[f] / .47 + "%")
    }
    var g = function(e) {
        for (var t, n = ["", "webkit", "moz", "ms", "o"], i = 0; !t && i < n.length; i++)
            t = e[a("transitionDuration", n[i])];
        var o = /((?:\d*\.)?\d+)(m?s)/.exec(t || "0s")
          , r = parseFloat(o[1]);
        switch (o[2]) {
        case "s":
            return 1e3 * r;
        default:
        case "ms":
            return r
        }
    }(getComputedStyle(m.get(0)));
    peppers.checkMobile.css.isMobile() && e.cookie("muted", 1, {
        path: "/",
        expires: 3650
    }),
    l.find(".mute-btn__checkbox").change(n).prop("checked", 1 === parseInt(e.cookie("muted"))).change()
}(jQuery, document),
function(e, t) {
    function n(n) {
        function i() {
            e(t).off("resize", a).on("resize", a),
            n.off("scroll:refresh", a).on("scroll:refresh", a),
            a()
        }
        function o() {
            e(t).off("resize", a),
            n.off("scroll:refresh", a)
        }
        function a(e) {
            var t = {
                width: n.width(),
                height: n.height()
            };
            n.siblings(".scroll-mask").find("rect").attr(t)
        }
        n.on("scroll:show", i).on("scroll:hide", o)
    }
    e.fn.scrollCustom = function() {
        this.each(function() {
            var t = e(this);
            t.data("scrollCustom") || t.data("scrollCustom", new n(t))
        })
    }
}(jQuery, window),
function(e, t) {
    function n(e) {
        function n() {
            return s = new IScroll(e.get(0),{
                scrollX: !1,
                scrollbars: "custom",
                mouseWheel: !0,
                momentum: !1,
                disableMouse: !0,
                disablePointer: !0,
                disableTouch: !1,
                bindToWrapper: !0,
                keyBindings: !0
            }),
            s.on("refresh", r),
            s.on("scrollStart", o),
            s.on("scrollEnd", a),
            s.on("scrollCancel", i),
            e.parent().append(c = e.find(".iScrollLoneScrollbar")),
            this
        }
        function i() {
            clearInterval(l)
        }
        function o() {
            var t = this;
            l = setInterval(function() {
                0 == t.y && -1 == t.directionY ? e.trigger("scroll:top") : t.hasVerticalScroll && e.trigger("scroll:scrolled")
            }, 50),
            this.y - this.maxScrollY < 50 && e.trigger("scroll:bottom")
        }
        function a() {
            clearInterval(l),
            0 === this.y && e.trigger("scroll:top"),
            this.y - this.maxScrollY < 50 && e.trigger("scroll:bottom")
        }
        function r() {
            0 === this.y ? e.trigger("scroll:top") : e.trigger("scroll:scrolled"),
            e.closest(".scroll").trigger("scroll:refresh"),
            s.hasVerticalScroll ? s.indicators[0].wrapper.classList.remove("is-disabled") : s.indicators[0].wrapper.classList.add("is-disabled")
        }
        var s, c, l;
        e.find("a").on("click", function(e) {
            s && (console.debug(">>>", s.moved),
            s.moved && e.preventDefault())
        }),
        this.scrollTo = function(e) {
            return s && s.scrollTo(0, e, 200),
            this
        }
        ,
        this.refresh = function() {
            return t.checkMobile.css.isMobile() ? (s && (s.destroy(),
            c.remove()),
            s = void 0) : s || n(),
            s && s.refresh(),
            this
        }
    }
    e.fn.scrollbarCustom = t.jQueryConstructor("scrollCustom", n)
}(jQuery, peppers = peppers || {});
var peppers;
!function(e, t, n, i, o) {
    function a(e, t) {
        function n() {
            var e = .5 * t;
            i(r, e, .5),
            i(s, e, .5),
            i(h, e + .25, .3),
            i(d, e + .45, .3),
            i(f, e + .35, .2),
            i(m, e + .4, .2)
        }
        function i(e, t, n, i, a) {
            e.css("transform", i || "scale(0)"),
            o.to(e.get(0), n || .5, {
                transform: a || "scale(1)",
                delay: t
            })
        }
        function a() {
            o.to(e.get(0), .3, {
                transform: "scale(0)",
                onComplete: function() {
                    e.trigger(p)
                }
            })
        }
        e.click(function() {
            e.trigger(u, t)
        });
        var r = e.find(".earth-popup__preview-hexagon")
          , s = e.find(".earth-popup__item-shadow")
          , h = e.find(".earth-popup__flag-hexagon")
          , d = e.find(".hexagon-svg")
          , f = e.find(".earth-popup__city")
          , m = e.find(".earth-popup__briefs-count");
        this.init = function(e) {
            switch (e) {
            case c:
                n();
                break;
            case l:
                a()
            }
        }
    }
    var r, s, c = "show", l = "hide", u = "item:select", p = "item:remove";
    i.fn.earthPopupItem = function(e) {
        return this.each(function(t, n) {
            var o = i(this)
              , r = o.data("earthPopupItem");
            r || o.data("earthPopupItem", r = new a(o,t)),
            r.init(e)
        })
    }
    ,
    e.getHexaspherePopup = function(e, n) {
        var o, a;
        return r || (s = i("#earth-popup[type='text/x-handlebars-template']"),
        r = t.compile(s.html())),
        o = i(r(e)).appendTo(s.parent()),
        o.localization("en"),
        a = o.find(".earth-popup__item").on(u, function(t, i) {
            n(e[i])
        }).on(p, function() {
            o.remove(),
            o = void 0,
            a = void 0
        }).earthPopupItem(c),
        {
            element: o.get(0),
            action: function(e) {
                o && o.toggleClass("earth-popup_moving", !0 === e || "mousedown" === e)
            },
            close: function() {
                a && a.earthPopupItem(l),
                a = void 0
            }
        }
    }
}(kaspersky = kaspersky || {}, Handlebars, document, jQuery, TweenLite);
var kaspersky;
!function(e, t, n, i) {
    function o(i) {
        function o(n, i) {
            function o() {
                b = !0,
                y = void 0,
                _ = k - Math.floor(k) > .1 ? .04 : 0
            }
            function a() {
                v = !0,
                b = !1,
                y || (h(),
                n.on("mousemove", r))
            }
            function r(e) {
                var t = l.parent().offset()
                  , n = e.pageX - t.left
                  , i = e.pageY - t.top
                  , o = Math.atan2(i, n) / Math.PI
                  , a = o < .25 && o > -.5 ? 1 : 0
                  , r = Math.abs(k - Math.floor(k));
                _ = a * Math.min(1, Math.max(0, Math.sqrt(n * n + i * i) - 80 * (1 - r)) / 160) * .08
            }
            function p() {
                _ = 0,
                n.off("mousemove", r),
                cancelAnimationFrame(y),
                y = void 0
            }
            function h() {
                y = requestAnimationFrame(h),
                g()
            }
            function f() {
                l && (l.off().remove(),
                u.splice(u.indexOf(l), 1)),
                w = void 0,
                l = void 0
            }
            function m() {
                f(),
                c.css(s(void 0)),
                c.each(function() {
                    d.append(this)
                })
            }
            function g() {
                b && Math.floor(k) != Math.floor(k + _) ? (k = Math.ceil(k),
                p()) : k += _;
                var t = Math.floor(k)
                  , n = k - t
                  , o = ((i - 1 - t) % i + i) % i;
                if (!l || o !== w) {
                    for (f(),
                    w = o,
                    l = e(c.eq(w).clone()),
                    l.addClass("HELPER"),
                    u.splice(o, 0, l),
                    r = o + 1; r < o + 1 + u.length; r++)
                        d.append(u[r % u.length]);
                    console.log(u),
                    console.log(d)
                }
                for (var a = u.length, r = 0; r < a; r++) {
                    var h = ((o + 1 + r) % a + a) % a
                      , m = u[h];
                    m ? m.css(s(r + n)) : console.debug(h)
                }
            }
            var v, b, w, y, k = 3, _ = 0;
            t.checkMobile.css.listen(function(e, t) {
                var i = t ? n.off : n.on;
                i.apply(n, ["mouseover", a]),
                i.apply(n, ["mouseleave", o]),
                t ? m() : g()
            })
        }
        function r(t, n, i) {
            var o = e.extend({}, t, n);
            for (var a in o)
                o.hasOwnProperty(a) && (o[a] = t[a] + (n[a] - t[a]) * i);
            return o
        }
        function s(e) {
            if (void 0 === e)
                return {
                    transform: "",
                    opacity: "",
                    filter: ""
                };
            var t = Math.floor(e)
              , n = Math.ceil(e);
            if (n >= a.length || t < 0)
                return {
                    display: "none"
                };
            var i = r(a[t], a[n], e - t);
            return {
                display: "",
                transform: "scale(" + i.scale + ") translate(" + i.x + "px," + i.y + "px)",
                opacity: i.opacity,
                filter: "brightness(" + i.brightness + ")"
            }
        }
        var c, l, u = [], p = this, h = i.find(".best-of-week__decor-hexagon"), d = i.find(".best-of-week__carousel"), f = i.find(".backdrop");
        !function(t) {
            function o() {
                r();
                var t = (e(i).find(".best-of-week__modal").css("display", "block"),
                h.find(".best-of-week__item"));
                if (TweenLite.killTweensOf(h.get(0)),
                TweenLite.killTweensOf(t.get(0)),
                h.css("opacity", 0),
                t.css({
                    opacity: "",
                    fontSize: ""
                }),
                TweenLite.to(h.get(0), .35, {
                    opacity: 1,
                    delay: .3,
                    ease: new Ease(function(e, t, n, i) {
                        return ~~(Math.abs(e - .2) < .1 || Math.abs(e - .55) < .05 || Math.abs(e - .75) < .05 || Math.abs(e - .9) < .1)
                    }
                    ),
                    onComplete: function() {
                        TweenLite.to(t.get(0), .1, {
                            opacity: 0,
                            fontSize: 0,
                            ease: Sine.easeIn
                        })
                    }
                }),
                c) {
                    c.css("fontSize", "");
                    var n = c.css("fontSize");
                    c.css({
                        fontSize: 0,
                        opacity: 0
                    }),
                    c.each(function(e) {
                        var t = this;
                        TweenLite.killTweensOf(t),
                        TweenLite.to(t, .3, {
                            fontSize: parseFloat(n),
                            opacity: 1,
                            delay: .5 + .03 * e,
                            onComplete: function() {
                                this.target.style.fontSize = "",
                                this.target.style.opacity = ""
                            }
                        })
                    })
                }
            }
            function a() {
                var t = e(i).find(".best-of-week__modal").css("display", "block")
                  , n = h.find(".best-of-week__item");
                TweenLite.killTweensOf(h.get(0)),
                TweenLite.killTweensOf(n.get(0)),
                h.css("opacity", 0),
                n.css({
                    opacity: "",
                    fontSize: 100
                }),
                TweenLite.to(h.get(0), .15, {
                    opacity: .3,
                    ease: new Ease(function(e) {
                        return Math.sin(e * Math.PI)
                    }
                    ),
                    delay: .15
                }),
                TweenLite.to(n.get(0), .15, {
                    fontSize: 600,
                    delay: .15,
                    ease: Sine.easeOut,
                    onComplete: function() {
                        t.css("display", ""),
                        r()
                    }
                }),
                c && c.each(function(t) {
                    var n = this;
                    TweenLite.killTweensOf(n),
                    TweenLite.to(n, .3, {
                        fontSize: 50,
                        opacity: 0,
                        onComplete: function() {
                            e(n).css({
                                fontSize: "",
                                opacity: ""
                            })
                        }
                    })
                })
            }
            function r() {
                e(n.documentElement).trigger("best-of-week:toggle")
            }
            t.on("change", function() {
                var t = e(this).is(":checked");
                f.toggleClass("backdrop_visible", t),
                t ? o() : a()
            }).change()
        }(i.find("#best-of-week__checkbox")),
        p.init = function(t) {
            c = e(".best-of-week").find(".best-of-week__item-container"),
            d.append(c),
            c.each(function(t) {
                u.push(e(this).css("animationDelay", 1 + .1 * t + "s"))
            }),
            o(i, c.length)
        }
    }
    var a = [{
        scale: .65,
        x: 238,
        y: -181,
        opacity: 0,
        brightness: .3
    }, {
        scale: .75,
        x: 155,
        y: -141,
        opacity: 1,
        brightness: .3
    }, {
        scale: .84,
        x: 66,
        y: -80,
        opacity: 1,
        brightness: .45
    }, {
        scale: 1,
        x: 0,
        y: 0,
        opacity: 1,
        brightness: 1
    }, {
        scale: 1.2,
        x: -40,
        y: 130,
        opacity: 1,
        brightness: 0
    }];
    e.fn.bestOfWeek = function() {
        return new o(e(this)).init(),
        this
    }
}(window.jQuery, peppers = peppers || {}, document, window);
var peppers;
!function(e, t, n, i, o) {
    function a(e) {
        function a() {
            x.scaleX = x.scaleY = Math.min(1, e.height() / w.height),
            x.update()
        }
        function s() {
            for (var e = 0; e < m.length; e++)
                m[e]._redraw();
            x.update()
        }
        function c(e, t) {
            for (var n = 0; n < m.length; n++)
                m[n].mouse(e, t)
        }
        function l(e) {
            c(0, 9999999)
        }
        function u(e) {
            var n = t(this).offset();
            c(e.pageX - n.left - x.x, e.pageY - n.top - x.y)
        }
        function p(e, n, i) {
            var o = []
              , a = (w.height - 1) / e;
            a = Math.round((a - n.length) / (n.length - 1));
            var s = a + 1;
            a = a * (n.length - 1) + n.length,
            e = (w.height - 1) / (a - 1);
            var c;
            f = n.map(function(e, n, o) {
                var a = t(k(e)).insertBefore(y);
                if (n < o.length - 1)
                    for (var s = 0; s < 11; s++)
                        a.after(" <span class='timeline__dash'></span> ");
                var c = new r.Year(w.width,e,a.get(0));
                return e == i && d(c),
                c.addEventListener("__select", h),
                c
            });
            for (var l = [].concat(f), u = 0; u < a; u++)
                c = u % s == 0 ? l.shift() : new r.Dash(w.width),
                o.push(c),
                c.y = Math.round(e * u),
                x.addChild(c);
            return o
        }
        function h(t) {
            var n = t.currentTarget;
            if (n && v) {
                var o = v[n.year];
                if (o && o.length > 0) {
                    var a = Math.floor(Math.random() * o.length);
                    return void (i.location = o[a])
                }
            }
            e.is(".timeline_static") || d(t.currentTarget)
        }
        function d(n) {
            if (g != n) {
                var o = i.currentYear = ~~n.yearNum[0].innerText
                  , a = i.PLANET;
                a && a.state == a.IDLE && a.showYear(o),
                g && g.setSelected(!1),
                g = n,
                g.setSelected(!0),
                t(e).trigger("timeline:change", o)
            }
        }
        var f, m, g, v, b = !e.is(".timeline_static"), w = {
            width: 40,
            height: 360
        }, y = e.find("[type='text/x-handlebars-template']"), k = Handlebars.compile(y.html()), _ = function(e, n, i) {
            var a = e.find("canvas");
            return 0 == a.length && (a = t(o.createElement("canvas")),
            e.prepend(a)),
            a.attr({
                width: n,
                height: i
            }),
            a
        }(e, w.width, w.height), x = new n.Stage(_.get(0));
        w.height -= 20,
        x.y = 10,
        this.init = function(i, r) {
            m = p(8, i, r),
            x.enableMouseOver(25),
            x.update(),
            b ? (e.on("mousemove", u),
            e.on("mouseleave", l),
            n.Ticker.addEventListener("tick", s)) : (t(o.documentElement).on("resize:after", a),
            a())
        }
        ,
        this.initLinks = function(t, i) {
            var o = !!(t && t.length > 0);
            t && (v = t.reduce(function(e, t) {
                e[t.year] = e[t.year] || [];
                var n = null;
                if (i) {
                    var o = t.works.find(function(e) {
                        return e.user_id == i
                    });
                    n = o ? o.slug : null
                }
                var a = n ? "artworks/" + n : "predictions/" + t.id;
                return e[t.year].push(langUrl + a),
                e
            }, {}),
            f.forEach(function(e) {
                e.setActive(v && v[e.year] && v[e.year].length > 0)
            })),
            e.toggleClass("timeline_static", !o),
            o ? (e.on("mousemove", u),
            e.on("mouseleave", l),
            n.Ticker.addEventListener("tick", s)) : (e.off("mousemove", u),
            e.off("mouseleave", l),
            setTimeout(function() {
                n.Ticker.removeEventListener("tick", s)
            }, 1e3))
        }
    }
    var r = {};
    t.fn.pepTimeline = e.jQueryConstructor("$timeline", a),
    function(e) {
        function t(e) {
            this.Container_constructor(),
            this.distance = this.currentDistance = 0;
            var t = this.dash = new n.Shape;
            t.graphics.beginLinearGradientFill(["rgba(77, 193, 148, 1)", "rgba(77, 193, 148, 0)"], [.65, 1], 0, 0, e, 0).drawRect(0, 0, e, 1),
            t.alpha = .53,
            this.addChild(t),
            t.x = 13 - e
        }
        var i = n.extend(t, n.Container);
        i.mouse = function(e, t) {
            this.initDistance(this.getDistance(e, t))
        }
        ,
        i.getDistance = function(e, t) {
            var n = Math.abs(t - this.y);
            return (n = Math.max(0, 1 - n / 48)) * n
        }
        ,
        i.initDistance = function(e) {
            this.distance = e
        }
        ,
        i._redraw = function() {
            var e = this.currentDistance = this.currentDistance + .5 * (this.distance - this.currentDistance);
            this.dash.alpha = .53 + .47 * e,
            this.x = 12 * e
        }
        ,
        e.Dash = n.promote(t, "Container")
    }(r),
    function(e) {
        function i(e, i, o) {
            this.Dash_constructor(e),
            this.year = i,
            this.yearNum = t(o);
            var a = new n.DOMElement(this.yearNum.get(0));
            a.x = 20,
            this.dash.x = this.dash.x + 7,
            this.dash.alpha = 1,
            this.addChild(a);
            var r = this.img = new n.Bitmap("/images/timeline/selected-glow.png");
            r.alpha = 0,
            this.addChild(r),
            r.x = this.dash.x,
            r.y = -6;
            var s = this;
            this.yearNum.on("click", function() {
                !1 === s.isActive || s.selected || s.dispatchEvent(new n.Event("__select"))
            })
        }
        var o = n.extend(i, e.Dash);
        o.setActive = function(e) {
            this.isActive = !!e,
            this.yearNum.toggleClass("timeline__item_inactive", !this.isActive)
        }
        ,
        o._redraw = function() {
            this.selected || !1 === this.isActive || (this.Dash__redraw(),
            this.dash.alpha = 1,
            this.yearNum.css({
                fontSize: 14 + 10 * this.currentDistance
            }))
        }
        ,
        o.toggleSelected = function() {
            return this.setSelected(!this.selected),
            this
        }
        ,
        o.getSelected = function() {
            return this.selected
        }
        ,
        o.setSelected = function(e) {
            this.selected = e;
            var t, i, o;
            e ? (t = {
                color: "#00ffa7",
                fontWeight: 900,
                fontSize: 24
            },
            o = 20,
            i = 1) : (t = {
                color: "#ffffff",
                fontWeight: 500
            },
            o = 0,
            i = 0),
            this.yearNum.animate(t, 200),
            n.Tween.get(this.img).to({
                alpha: i
            }, 200),
            n.Tween.get(this).to({
                x: o
            }, 200),
            this.yearNum.toggleClass("timeline__item-selected", e),
            this.dash.filters = []
        }
        ,
        e.Year = n.promote(i, "Dash")
    }(r)
}(peppers = peppers || {}, jQuery, createjs, window, document);
var peppers;
!function(e, t, n, i, o) {
    function a(o) {
        function a(e, t) {
            w.briefCommentsList("add", {
                user: h().user,
                comment: t
            }),
            M.refresh()
        }
        function r(i) {
            var a = arguments[3];
            p !== a && (g.hide(),
            m = l({
                brief_id: p = a
            }),
            m.done(s).fail(function(n) {
                t.modal(),
                e.alert("ERROR", n)
            }),
            n(".addwork-link", o).attr("href", e.addwork_link(p)),
            v.addCommentForm(null, p))
        }
        function s(e) {
            o.find(".brief-city-name").html(e.location && e.location.city),
            g.fadeIn(400),
            d = e,
            y.agreeVote(e).on("vote:vote", c),
            b.briefModalContent(e),
            w.briefCommentsList(e.comments),
            v.not(":first-of-type").toggle(e.comments && e.comments.length >= 5),
            v.find("textarea").attr("placeholder", n.fn.localization.getText("brief.comment.placeholder")),
            n(i.documentElement).trigger("resize:after"),
            M.refresh(),
            M.scrollTo(0)
        }
        function c(t, n) {
            if (d && "boolean" != typeof d.voted && !f) {
                if (!e.user.isAuthorized())
                    return void e.user.auth();
                if ("boolean" == typeof n) {
                    f = !0;
                    var i = n ? "agree" : "disagree";
                    u({
                        brief_id: p,
                        agree: i
                    }).done(function(e) {
                        d[i] = e[i] || 1 + ~~(d[i] || 0),
                        d.voted = i,
                        y.agreeVote(d)
                    }).fail(function(t) {
                        e.alert(t)
                    }).always(function() {
                        f = !1
                    })
                }
            }
        }
        var l, u, p, h, d, f, m, g = o.children();
        o.on("modal-item:change", r);
        var v = o.find(".add-comment-form").on("add-comment-form:add", a)
          , b = o.find(".brief-modal__cont").briefModalContent()
          , w = o.find(".brief-comments-list").briefCommentsList()
          , y = o.find(".agree-vote")
          , k = n(".show-graphics")
          , _ = k.find("a")
          , x = o.find(".scroll__masked")
          , M = x.scrollbarCustom().data("scrollCustom");
        x.on("scroll:scrolled", function(e) {
            k.removeClass("scroll-visible")
        }),
        x.on("scroll:top", function(e) {
            k.addClass("scroll-visible")
        }),
        n(i.documentElement).on("resize:after", function() {
            if (M.refresh(),
            k.css("right", n(".k-menu__authorization").outerWidth()),
            t.checkMobile.css.isMobile() || i.body.clientWidth < 1025) {
                var e = o.find(".brief-city-name--mobile");
                i.body.clientWidth - 2 * e.offset().left < k.outerWidth() + e.outerWidth() ? o.addClass("show-graphics--position-down") : o.removeClass("show-graphics--position-down")
            }
        }),
        o.on("modal-item:show  modal-item:hide", function(e) {
            m.always(function() {
                M.refresh(),
                o.find(".scroll").trigger(e.type.replace("modal-item", "scroll")),
                d.works_count > 0 && "modal-item:show" === e.type ? (_.attr("href", "prediction?brief_id=" + p),
                k.addClass("visible")) : (_.attr("href", "#"),
                k.removeClass("visible"))
            })
        });
        var C = null;
        o.on("modal-item:show", function() {
            m.always(function() {
                C || (C = e.get_metadata(),
                n("title").html(d.title),
                n('meta[property="og:title"]').attr("content", d.title),
                n('meta[property="og:description"]').attr("content", d.stripped_body),
                n('meta[property="og:image"]').attr("content", d.image_share),
                n('meta[property="og:url"]').attr("content", d.share_url),
                n('meta[name="description"]').attr("content", d.stripped_body))
            })
        }),
        o.on("modal-item:hide", function() {
            m.always(function() {
                C && (e.set_metadata(C),
                C = null)
            })
        }),
        o.on("scroll:do_refresh", function() {
            M.refresh()
        }),
        this.init = function(e, t, n, i) {
            i && (h = i),
            e && (l = e),
            n && (u = n),
            t && v.addCommentForm(t)
        }
    }
    n.fn.briefModal = t.jQueryConstructor("BriefModal", a)
}(kaspersky = kaspersky || {}, peppers = peppers || {}, jQuery, document, Handlebars);
var kaspersky, peppers;
!function(e, t, n, i, o) {
    function a(n) {
        function i() {
            a()
        }
        function o() {
            var e = t(".timeline")
              , n = e.data("$timeline");
            if (n) {
                var i = r.brief_attached
                  , a = r.author_id;
                n.initLinks(i, a)
            } else
                e.one("timeline:init", function() {
                    o()
                })
        }
        function a() {
            s.briefUser(r),
            r.is_panorama && c.briefPanorama(r),
            o()
        }
        var r = e.artwork
          , s = t(".brief-user", n)
          , c = t(".brief__panorama", n);
        this.init = function() {
            i()
        }
    }
    function r(e) {
        var t = o.compile(e.attr("href"));
        this.init = function(n) {
            e.toggle(n.carousel),
            e.attr("href", t(n))
        }
    }
    function s(o) {
        function a() {
            if (!e.isAuthorized)
                return void (window.location = e.loginUrl + "?next=" + n.pathname);
            if (!e.liked) {
                e.liked = !0;
                var i = t(".brief-user__likes-value");
                t(i[0]).text(parseInt(t(i[0]).text()) + 1),
                t(i[1]).text(parseInt(t(i[1]).text()) + 1),
                t(".brief-user__like-btn").addClass("nohover"),
                e.likeApi({
                    artwork_id: e.artwork.id
                }).fail(function(e) {
                    alert(e.statusText)
                })
            }
        }
        var s, c = new r(t(".brief-360__arrow_prev")), l = new r(t(".brief-360__arrow_next")), u = t(i.documentElement);
        this.init = function(e) {
            function n() {
                s.find(".skew").css("visibility", "").stop().filter(":visible").css({
                    width: "",
                    minWidth: ""
                }).each(function() {
                    var e = t(this)
                      , n = e.children().outerWidth();
                    e.data("width", n)
                }).css({
                    width: 0,
                    minWidth: "inherit"
                }).each(function(e) {
                    var n = t(this).delay(1e3 + 200 * e).animate({
                        width: t(this).data("width")
                    }, 500);
                    n.is(".brief-user__index") || n.find(".skew__text").css("margin-left", "-11rem")
                })
            }
            u.off("resize:after", n),
            s && s.remove(),
            s = t(".brief-user"),
            c.init(e),
            l.init(e),
            s.find(".brief-user__like-btn").on("click", a),
            s.find(".skew").css("visibility", "hidden"),
            t(".user-pic", o).addClass("user-pic--visible"),
            u.data("size") ? n() : u.one("resize:after", n),
            setTimeout(function() {
                t(".brief-user__arrow", o).addClass("brief-user__arrow_visible")
            }, 1600)
        }
    }
    function c(e) {
        function n(t) {
            s || (s = new PNRM.GUI,
            r = window.panoramaViewer = new PNRM.Player(e,s));
            var n = t.points;
            if (n) {
                if ("string" == typeof n) {
                    n = t.points = JSON.parse(n);
                    for (var i = 0; i < n.length; i++) {
                        var o = n[i]
                          , a = o.data.split(";");
                        o.x = parseFloat(a[0]),
                        o.y = parseFloat(a[1]),
                        o.z = parseFloat(a[2]),
                        o.name = o.brief_name,
                        o.link = o.brief_id
                    }
                }
            } else
                t.points = [];
            l.finish().fadeIn(100),
            u.finish().fadeOut(100),
            r.createPanorama(t, function() {
                l.finish().fadeOut(100),
                p || u.finish().fadeIn(100)
            }),
            c = r.VR
        }
        function i(e) {
            c.enableVR(e),
            r.fullscreenToggle(e),
            u.finish().hide()
        }
        function o() {
            Util.addEvent("up", h, a),
            Util.addEvent("move", h, function() {
                u.finish().fadeOut(),
                Util.removeEvent("down", h, o),
                a(),
                p = !0
            })
        }
        function a() {
            Util.removeEvent("up", h, a),
            Util.removeEvent("move", h)
        }
        var r, s, c, l = t(".transition__preloader", e);
        this.init = function(e) {
            n(e)
        }
        ,
        t(".to-vr").click(function() {
            i(!0)
        });
        var u = t(".tooltip-360", e);
        u.hide();
        var p = !1
          , h = t(window);
        Util.addEvent("down", h, o)
    }
    !function() {
        var e = t.Deferred();
        t(i).on("fade:complete", function() {
            e.resolve()
        }),
        e.promise()
    }();
    t.fn.brief = peppers.jQueryConstructor("brief", a),
    t.fn.briefUser = function(e) {
        this.each(function() {
            var n = t(this)
              , i = n.data("BriefUser");
            i || n.data("BriefUser", i = new s(n)),
            i.init(e)
        })
    }
    ,
    t.fn.briefPanorama = peppers.jQueryConstructor("briefPanorama", c)
}(kaspersky = kaspersky || {}, jQuery, window.location, document, Handlebars);
var kaspersky;
!function(e, t, n, o, a, r, s, c) {
    function l(t) {
        for (var n in t)
            t.hasOwnProperty(n) && /^\d+$/.test(n) && t[n].briefs.sort(function(e, t) {
                return t.votes - e.votes
            }).forEach(function(t) {
                t.link = e.brief_page_link(t),
                t.names = [{
                    list: e.trimText(t.name, 18, 3),
                    type: "desktop"
                }, {
                    list: e.trimText(t.name, 10, 5),
                    type: "mobile"
                }]
            });
        return t
    }
    function u(e, t, n) {
        function i(e) {
            o("mouseenter" == e.type, !0)
        }
        function o(t, n) {
            function i(e, t, n, i) {
                (t ? e.find("." + n) : e).toggleClass(n + "_visible", i)
            }
            var o = new r.Event("visible:toggle");
            if (o.data = {
                visible: t,
                mouse: !!n
            },
            l.dispatchEvent(o),
            c !== t) {
                c = t;
                var p = e;
                i(p, !1, u + "point", t),
                i(p, !0, u + "concept-info", t),
                i(p, !0, "concept-name__line", t),
                clearTimeout(s),
                s = setTimeout(function() {
                    a = t
                }, t ? 300 : 0)
            }
        }
        var a, s, c, l = this, u = "hexagonal-map__";
        this.jQueryElement = e,
        this.initVisible = o,
        this.DOMElement_constructor(e.get(0)),
        this.x = t.x,
        this.y = t.y,
        t.x > .5 * n && e.find(".concept-name").addClass("concept-name_right"),
        e.on("click", function(e) {
            if (!a)
                return e.preventDefault(),
                !1
        }),
        e.on("mouseenter  mouseleave", i),
        this.mapPoint = e.find(".hexagonal-map__point").css({
            transform: "scale(0)"
        })
    }
    function p(e) {
        function n(e) {
            t.load(e).done(function(e) {
                u.resolve({
                    image: e.get(0),
                    info: {
                        imgWidth: r,
                        imgHeight: s,
                        width: o,
                        height: o,
                        dx: -i,
                        dy: -i
                    }
                }),
                e.remove()
            }).fail(function() {
                var t = "images/hex.svg";
                e != t && n(t)
            })
        }
        var i = 4
          , o = 2 * i
          , r = o + 1
          , s = o + 1
          , c = {
            alpha: 1,
            color: "#31B987",
            points: "2.5,8.5 0.5,4.5 2.5,0.5 6.5,0.5 8.5,4.5 6.5,8.5"
        };
        c = a.extend(c, e);
        var l = '<svg x="0px" y="0px" width="9" height="9"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><polygon vector-effect="non-scaling-stroke" style="opacity:{{alpha}};fill:{{color}};" points="{{points}}"/><polygon vector-effect="non-scaling-stroke" style="fill:none;stroke:{{color}};stroke-miterlimit:10;" points="{{points}}"/></svg>';
        l = l.replace(/\{{2}([_\w\d]+)\}{2}/g, function(e, t) {
            return c[t]
        });
        var u = a.Deferred();
        return n("data:image/svg+xml;utf8," + encodeURIComponent(l)),
        u.promise()
    }
    function h(e) {
        this.canvases = [];
        for (var t = 0; t < e; t++) {
            var n = o.createElement("canvas");
            n.context = n.getContext("2d"),
            this.canvases.push(n)
        }
    }
    function d(e, t, n, i) {
        var o = 4 * (Math.floor(n) * i + Math.floor(t));
        return e.slice(o, o + 4)
    }
    function f(e) {
        for (var t = e[0].clone(), n = e[0].clone(), i = 0; i < e.length; i++)
            t.x = Math.min(t.x, e[i].x),
            t.y = Math.min(t.y, e[i].y),
            n.x = Math.max(n.x, e[i].x),
            n.y = Math.max(n.y, e[i].y);
        return {
            x: t.x,
            y: t.y,
            width: n.x - t.x,
            height: n.y - t.y,
            left: t.x,
            top: t.y,
            bottom: n.y,
            right: n.x
        }
    }
    var m, g = (Math.sqrt(3),
    .5);
    a.fn.hexagonalMap = function(t) {
        var n;
        this.each(function() {
            m || (m = a.when(p({
                alpha: .4
            })));
            var i = a(this)
              , o = i.data("hexagonal-map");
            o || i.data("hexagonal-map", o = new e.HexagonalMap(i,i.find(".hexagonal-map__canvas-map").get(0),i.find(".hexagonal-map__canvas-shadow").get(0),{
                size: 8,
                offset: 0,
                border: 0
            })),
            o.init(n = n || t({
                location_id: e.location
            }, l))
        })
    }
    ;
    var v = r.extend(u, r.DOMElement);
    v.show = function(e) {
        s.to(this.mapPoint.get(0), .4, {
            transform: "scale(1)",
            delay: e || 0,
            ease: Back.easeOut
        })
    }
    ,
    v.hide = function(e) {
        var t = this;
        this.jQueryElement.off(),
        s.to(this.mapPoint.get(0), .4, {
            transform: "scale(0)",
            delay: e || 0,
            ease: Sine.easeIn,
            onComplete: function() {
                t.jQueryElement.remove(),
                delete t.mapPoint,
                delete t.jQueryElement
            }
        })
    }
    ,
    v.scale = function(e) {
        this.scaleX = this.scaleY = e,
        this.htmlElement && this._handleDrawEnd()
    }
    ,
    v._handleDrawEnd = function() {
        this.DOMElement__handleDrawEnd();
        var e = this.htmlElement;
        if (e) {
            var t = e.style;
            t.transform = t.transform.replace(/px/g, "")
        }
    }
    ,
    r.promote(u, "DOMElement"),
    e.HexagonalMap = function(e, n, c, l) {
        function p() {
            e.find(".hexagonal-map__container").css({
                transform: "scale(" + Q.scale + ")",
                width: Q.width * Q.scale,
                height: Q.height * Q.scale
            });
            for (var t = 1 / Q.scale, n = 0; n < q.length; n++)
                q[n].scale(t)
        }
        function v(e, t) {
            j = t,
            y()
        }
        function b(e) {
            console.debug(e),
            O.find(".city-name__city").html(e.location && e.location.city || "CITY"),
            O.find(".city-name__country").html(e.location && e.location.country || "COUNTRY"),
            S = e,
            y()
        }
        function w() {
            for (var e = a.Deferred(); q.length; ) {
                var t = q.pop();
                $.removeChild(t),
                t.hide()
            }
            if (E && (E.destroy(),
            E = void 0),
            $.children.length > 0) {
                T([e.promise()]);
                for (var n = 0; n < $.children.length; n++)
                    !function(t, n) {
                        s.to(t, .25, {
                            alpha: 0,
                            delay: .2 + .1 * n,
                            ease: Sine.easeOut,
                            onComplete: function() {
                                $.removeChild(t),
                                0 === $.children.length && e.resolve()
                            }
                        })
                    }($.children[n], n)
            } else
                e.resolve();
            return e.promise()
        }
        function y() {
            S && j && a.when(m, t.load(S[j].url), w()).done(k).fail(function(e) {
                console.log(e)
            })
        }
        function k(e, i) {
            function r() {
                z(m);
                for (var e = S[j].briefs, t = 0; t < e.length; t++) {
                    var i = e[t]
                      , o = a(P(i))
                      , r = o.find(".map-point")
                      , s = !1;
                    if (i.image && i.image.url) {
                        var c = "string" == typeof i.image.url ? i.image.url : i.image.url.first;
                        console.log(c),
                        c && !/no (image|preview)/i.test(c) || (s = !0)
                    } else
                        s = !0;
                    r.toggleClass("map-point_" + i.type, !!i.type).toggleClass("map-point_no-image", s).toggleClass("map-point_no-works", !(i.works_count > 0)),
                    o.find(".hexagonal-map__concept-info").toggleClass("hexagonal-map__concept-info_no-image", s),
                    H.append(o);
                    var l = new u(o,h.points[d[t]],n.width);
                    $.addChild(l),
                    q.push(l),
                    l.addEventListener("visible:toggle", function(e) {
                        e.data.mouse && E.toggle(!e.data.visible)
                    })
                }
                E && E.destroy(),
                E = new _(q).start(),
                p()
            }
            var s = e
              , c = t.getImageData(i, {
                width: 525
            })
              , h = x(c, s.info);
            i.remove();
            var d = M(h.points, h.centerPointIndex, S[j].briefs.length)
              , m = f(h.points);
            m.width += s.info.imgWidth,
            m.height += s.info.imgHeight,
            I.clear(),
            I.size(m.width, m.height);
            for (var g = 0; g < h.points.length; g++) {
                var v = s;
                !function(e, t, n, i) {
                    e.context.drawImage(n, l.border + t.dx + i.x, l.border + t.dy + i.y, t.imgWidth, t.imgHeight)
                }(I.random(), v.info, v.image, h.points[g])
            }
            D ? (a(o).one("fade:complete", r),
            D.resolve(),
            D = void 0) : r()
        }
        function _(e) {
            function t() {
                a && 0 != a.length || (a = n(e)),
                r && r.initVisible(!1),
                (r = a.pop()) && r.initVisible(!0)
            }
            function n(e) {
                for (var t = [].concat(e), n = t.length; n > 0; n--) {
                    var i = Math.random() * n;
                    t.push(t.splice(~~i, 1)[0])
                }
                return t
            }
            var i, o, a, r, s = this;
            this.destroy = function() {
                this.stop(),
                i = 3
            }
            ,
            this.toggle = function(e) {
                e ? this.start() : this.stop()
            }
            ,
            this.start = function() {
                if (1 != i && 3 != i)
                    return o = setInterval(t, 5e3),
                    t(),
                    s
            }
            ,
            this.stop = function() {
                if (2 != i && 3 != i)
                    return r && r.initVisible(!1),
                    r = void 0,
                    clearInterval(o),
                    s
            }
        }
        function x(e, n) {
            for (var i, o = e.data, a = e.width, r = e.height, s = -n.dx, c = -n.dy, u = Math.ceil(1.5 * n.width + l.offset), p = Math.ceil(n.height / 2 + l.offset), h = [], f = new t.Point(.5 * a,.5 * r), m = 999999, v = 0, b = c; b < r; b += p,
            v++)
                for (var w = 0, y = s + (1 & v) * u * .5; y < a; y += u,
                w++)
                    if (d(o, y, b, a)[3] >= g) {
                        var k = new t.Point(y,b);
                        k.index = {
                            h: w,
                            v: v
                        };
                        var _ = k.distance(f);
                        (_ < m || !i) && (m = _,
                        i = h.length),
                        h.push(k)
                    }
            return console.debug(v, w),
            {
                points: h,
                centerPointIndex: i
            }
        }
        function M(e, t, n) {
            function o(e, t) {
                for (var n = [], i = t.length - 1; i >= 0; i--)
                    C(e, t[i]) && n.push(t.splice(i, 1)[0]);
                return n
            }
            for (var a = [].concat(e), r = [t], s = [0], c = a.splice(t, 1).pop(), l = [].concat(o(c, a)); a.length > 0 && r.length < n; ) {
                var u = Math.floor(Math.random() * a.length);
                c = a.splice(u, 1).pop(),
                a != l && l.push.apply(l, o(c, a));
                var p = c.distance(r[0]);
                for (i = 1; i < s.length && p > s[i]; )
                    i++;
                s.splice(i, 0, p),
                r.splice(i, 0, e.indexOf(c)),
                0 === a.length && (console.debug("use neighbors"),
                a = l)
            }
            return r
        }
        function C(e, t) {
            var n = Math.abs(e.index.v - t.index.v)
              , i = Math.abs(e.index.h - t.index.h);
            return 0 == i && n < 4 && n % 2 == 0 || n < 4 && n % 2 == 1 && (0 == i || e.index.h + (e.index.v % 2 * 2 - 1) == t.index.h) || 0 == n && i < 2
        }
        function z(e) {
            var t;
            c.width = n.width = e.width,
            c.height = n.height = e.height,
            Q.width = parseFloat(n.width),
            Q.height = parseFloat(n.height);
            for (var i = [], o = 0; o < I.canvases.length; o++) {
                t = new r.Bitmap(I.canvases[o]),
                t.alpha = 0,
                $.addChild(t);
                var l = a.Deferred();
                s.to(t, .5, {
                    alpha: 1,
                    delay: .2 + .1 * o,
                    ease: Sine.easeOut,
                    onComplete: l.resolve
                }),
                i.push(l.promise())
            }
            T(i).then(function() {
                for (var e = Math.max(.08, Math.min(.2, 1 / q.length)), t = 0; t < q.length; t++)
                    q[t].show(.2 + t * e)
            })
        }
        function T(e) {
            function t() {
                o = !0
            }
            function i() {
                $.update(),
                A.cache(0, 0, n.width, n.height),
                L.update(),
                o && (r.Ticker.removeEventListener("tick", i),
                s.resolve())
            }
            var o, s = a.Deferred();
            return r.Ticker.addEventListener("tick", i),
            a.when.apply(null, e).then(t),
            i(),
            s.promise()
        }
        var S, j, E, D = void 0, O = e.closest(".kaspersky-app").find(".city-name"), P = Handlebars.compile(e.find('[type="text/x-handlebars-template"]').html()), $ = new r.Stage(n), L = new r.Stage(c), I = new h(5), A = function(e, t) {
            var n = new r.Bitmap(e);
            return t.addChild(n),
            n.alpha = .2,
            n.filters = [new r.ColorFilter(1,1,1,2.5), new r.BlurFilter(6,6,2)],
            n
        }(n, L), q = [], H = e.find(".hexagonal-map__points-cont"), Q = {};
        a(o.documentElement).on("resize:after", function() {
            Q.scale = parseFloat(a(this).css("fontSize")) / 18,
            p()
        }),
        a(o).on("timeline:change", v),
        this.init = function(e) {
            e.done(b)
        }
    }
    ,
    h.prototype.size = function(e, t) {
        1 == arguments.length && (t = e);
        for (var n = 0; n < this.canvases.length; n++)
            this.canvases[n].width = e,
            this.canvases[n].height = t;
        return this
    }
    ,
    h.prototype.random = function() {
        var e = Math.random() * this.canvases.length;
        return this.canvases[Math.floor(e)]
    }
    ,
    h.prototype.join = function(e) {
        var t, n = this.canvases;
        t = "number" == typeof e ? n[e].context : e.getContext("2d");
        for (var i = 0; i < n.length; i++)
            i != e && t.drawImage(n[i], 0, 0, n[i].width, n[i].height);
        return n[e]
    }
    ,
    h.prototype.clear = function() {
        for (var e = 0; e < this.canvases.length; e++)
            this.canvases[e].context.clearRect(0, 0, this.canvases[e].width, this.canvases[e].height)
    }
}(kaspersky = kaspersky || {}, peppers = peppers || {}, window, document, jQuery, createjs, TweenLite, window.location);
var kaspersky, peppers;
!function(e, t, n) {
    function i(i) {
        function o(i) {
            i.preventDefault(),
            s(c.serialize()).done(function() {
                t.modal(),
                n.alert(e.fn.localization.getText("add_prediction.success") || "ADD SUCCESS")
            }).fail(function(e) {
                n.alert(e)
            })
        }
        function a() {
            i.find(".form").blink()
        }
        function r() {}
        var s, c = i.find("form").on("form:submit", o);
        i.on("modal-item:show", a).on("modal-item:hide", r),
        this.init = function(e) {
            s = e || s
        }
    }
    e.fn.addPrediction = function(t) {
        this.each(function() {
            var n = e(this)
              , o = n.data("add-prediction");
            o || n.data("add-prediction", o = new i(n)),
            o.init(t)
        })
    }
}(jQuery, peppers = peppers || {}, kaspersky = kaspersky || {});
var peppers, kaspersky;
!function(e, t, n) {
    function i(e) {
        function i(e) {
            e.preventDefault(),
            r(s.serialize()).done(function() {
                n.user.accept_terms(),
                t.modal()
            }).fail(function(e) {
                n.alert(e)
            })
        }
        function o() {
            e.find(".form").blink()
        }
        function a() {}
        var r, s = e.find("form").on("form:submit", i);
        e.on("modal-item:show", o).on("modal-item:hide", a),
        this.init = function(e) {
            r = e || r
        }
    }
    e.fn.termsAccepted = function(t) {
        this.each(function() {
            var n = e(this)
              , o = n.data("terms-accepted");
            o || n.data("terms-accepted", o = new i(n)),
            o.init(t)
        })
    }
}(jQuery, peppers = peppers || {}, kaspersky = kaspersky || {});
var peppers, kaspersky;
!function(e, t, n, i) {
    function o(o) {
        function a(e) {
            e.preventDefault(),
            o.trigger("modal:hide")
        }
        function r() {
            s || c || "alert" !== n.hash.getHash()[1] || n.modal()
        }
        var s, c, l = this, u = o.find(".modal-message__title"), p = o.find(".modal-message__body");
        e(t).on("hashchange", r),
        o.find(".button_no-lines").on("click", a),
        i.alert = function(t, i, o) {
            "already voted: agree" == t ? t = e.fn.localization.getText("voted.agree") || "already voted: agree" : "already voted: disagree" == t && (t = e.fn.localization.getText("voted.disagree") || "already voted: disagree"),
            l.init(t, i),
            n.modal("alert", o || location.hash)
        }
        ,
        this.init = function(e, t) {
            u.html(s = e || ""),
            p.html(c = t || ""),
            r()
        }
    }
    e.fn.alert = n.jQueryConstructor("alert", o)
}(jQuery, window, peppers = peppers || {}, kaspersky = kaspersky || {});
var peppers, kaspersky;
!function(e, t) {
    function n() {
        var t = o();
        e(".authorization").toggleClass("authorization_authorized", !!t),
        e(".predictions__likes").toggleClass("visible", !!t),
        e(".predictions__rank").toggleClass("visible", !!t)
    }
    var i, o;
    e.fn.authorization = function(a) {
        return o = a || o,
        !i && this.length > 0 && (i = !0,
        e(t).on("login:change", n),
        n()),
        this
    }
}(jQuery, window),
function(e, t, n) {
    function i(e, t) {
        var n = new FileReader;
        n.onload = function(e) {
            var n = new DataView(e.target.result);
            if (65496 != n.getUint16(0, !1))
                return t(-2);
            for (var i = n.byteLength, o = 2; o < i; ) {
                var a = n.getUint16(o, !1);
                if (o += 2,
                65505 == a) {
                    if (1165519206 != n.getUint32(o += 2, !1))
                        return t(-1);
                    var r = 18761 == n.getUint16(o += 6, !1);
                    o += n.getUint32(o + 4, r);
                    var s = n.getUint16(o, r);
                    o += 2;
                    for (var c = 0; c < s; c++)
                        if (274 == n.getUint16(o + 12 * c, r))
                            return t(n.getUint16(o + 12 * c + 8, r))
                } else {
                    if (65280 != (65280 & a))
                        break;
                    o += n.getUint16(o, !1)
                }
            }
            return t(-1)
        }
        ,
        n.readAsArrayBuffer(e.slice(0, 65536))
    }
    function o(o) {
        function a(e) {
            var n = t.getFiles(e)[0];
            n && i(n, function(e) {
                c = e,
                s(n, c)
            })
        }
        function r(e, t) {
            for (var n = e.split(","), i = n[0].match(/:(.*?);/)[1], o = atob(n[1]), a = o.length, r = new Uint8Array(a); a--; )
                r[a] = o.charCodeAt(a);
            return new File([r],t,{
                type: i
            })
        }
        function s(i, a) {
            function r(e, n) {
                c = n,
                t.Image(i).rotate(l[a]).resize(p.preview.width, p.preview.height, "min").get(function(e, t) {
                    e || (u.off("user-pic-crop:save").userPicCrop(t, o.data("title")).on("user-pic-crop:save", s),
                    h.val(""))
                })
            }
            function s(e, n) {
                var r = n.height * c.height / (n.width * c.width)
                  , s = Math.max(0, n.x)
                  , u = Math.max(0, n.y)
                  , p = Math.max(0, Math.min(n.width, 1 - n.x, n.width + n.x))
                  , h = Math.max(0, Math.min(n.height, 1 - n.y, n.height + n.y))
                  , d = p / n.width
                  , f = h / n.height;
                t.Image(i).rotate(l[a]).crop(s * c.width, u * c.height, p * c.width, h * c.height).get(function(e, t) {
                    if (e)
                        console.warn("upload error", e);
                    else {
                        var i = document.createElement("canvas")
                          , a = i.width = Math.min(1e3, Math.max(t.width, t.height / r))
                          , s = i.height = a * r;
                        i.getContext("2d").drawImage(t, 0, 0, t.width, t.height, a * (n.x < 0 ? 1 - d : 0), s * (n.y < 0 ? 1 - f : 0), a * d, s * f),
                        o.trigger("upload-image:crop", i)
                    }
                })
            }
            var c, u = e(".user-pic-crop");
            u.is(":visible") || peppers.modal("user-pic-crop", n.hash),
            t.getInfo(i, r)
        }
        var c = 1
          , l = {
            8: 270,
            3: 180,
            6: 90,
            7: 270,
            4: 180,
            5: 90
        }
          , u = peppers.checkMobile.css.isMobile() ? 484 : 333
          , p = {
            preview: {
                width: u,
                height: u
            }
        }
          , h = e('<input class="upload-image__input" name="photo" type="file" accept=".jpg,.jpeg,.png" />');
        o.append(h),
        t.event && t.event.on(h.get(0), "change", a),
        function() {
            if (void 0 !== kaspersky.avatar64) {
                var e = r(kaspersky.avatar64, kaspersky.avatarName);
                i(e, function(t) {
                    c = t,
                    s(e, c)
                })
            }
        }(),
        this.init = function(t, n) {
            switch (t) {
            case "upload":
                break;
            case "init":
                n && (p = e.extend(p, n))
            }
        }
    }
    e.fn.uploadImage = function(t, n) {
        return 1 === arguments.length && (n = t,
        t = "init"),
        this.each(function() {
            var i = e(this)
              , a = i.data("upload-image");
            a || i.data("upload-image", a = new o(i)),
            a.init(t, n)
        })
    }
}(jQuery, FileAPI, window.location),
function(e, t, n) {
    function i(i) {
        function a(e) {
            var t = i.find(e);
            return function(e) {
                o(t, e)
            }
        }
        function r(e) {
            var n = i.find(e);
            return function(e) {
                o(n, t.formatNumber(e || 0))
            }
        }
        var s = this;
        s.element = i,
        this.elements = {
            image: function(e) {
                var t = i.find(e);
                return function(e) {
                    o(t, e, !0, function() {
                        t.closest(".user-pic").addClass("user-pic--visible")
                    })
                }
            }(".user-data__userpic"),
            name: a(".user-data__username"),
            total_likes: r(".user-data__total-likes"),
            rank: r(".user-data__total-rank"),
            location: a(".user-data__location"),
            email: a(".user-data__email"),
            about: a(".user-data__about")
        },
        e(n).on("login:change", function() {
            s.update()
        })
    }
    function o(t, n, i, o) {
        n = n || "",
        t.each(function() {
            var t = e(this);
            switch (!0) {
            case t.is("input"):
            case t.is("textarea"):
                t.val(n);
                break;
            default:
                t.closest(".user-panel__stat-item").toggleClass("user-panel__stat-item_empty", !n && 0 !== n),
                i ? t.css("background-image", "url('" + n + "')") : t.html(n),
                "function" == typeof o && o()
            }
        })
    }
    e.fn.userData = t.jQueryConstructor("UserData", i),
    i.prototype.init = function(e) {
        if ("function" == typeof e)
            this.api = e;
        else
            var t = e;
        this.update(t)
    }
    ,
    i.prototype.update = function(e) {
        if (void 0 === e || (e.user.suadmin,
        0) ? window.suadmin = !1 : window.suadmin = !0,
        this.api || e) {
            e = e || this.api();
            for (var t in this.elements)
                this.elements.hasOwnProperty(t) && this.elements[t](e && e.user && e.user[t] || "");
            this.element.trigger("user-data:change")
        }
    }
}(jQuery, peppers = peppers || {}, document);
var peppers;
!function() {
    function e(e) {
        var t = e.find(".scroll__masked")
          , n = t.data("scrollCustom");
        n || (n = t.scrollbarCustom().data("scrollCustom"),
        $(document.documentElement).on("resize:after", n.refresh)),
        n.refresh()
    }
    function t(t) {
        var i = this.$el = $(t);
        e(i),
        i.find(".checkbox-nth").on("change", function() {
            if (peppers.checkMobile.css.isMobile()) {
                var e = $(this).parent()
                  , t = e.find(".checkbox-nth")
                  , n = t.index(this)
                  , i = e.find(".checkbox-nth-item")
                  , o = i.eq(n);
                i.toggleClass("my-discussion_hide", !0),
                o.toggleClass("my-discussion_hide", !1)
            }
        }),
        n($(".discussions"), "predictions"),
        n($(".uploaded-works"), "artworks")
    }
    function n(e, t) {
        function n(e) {
            function t() {
                n.animate({
                    opacity: 0,
                    top: -10,
                    height: 0,
                    padding: 0
                }, 200, function() {
                    n.remove(),
                    h = h.not(n),
                    a(d)
                }),
                $(document.documentElement).trigger("resize:after")
            }
            var n = $(this).closest("[data-id]");
            n.css("pointer-events", "none"),
            {}[p + "_id"] = n.data("id"),
            $.ajax({
                url: langUrl + "api/" + p + "/" + n.data("id"),
                type: "DELETE",
                success: t,
                error: function(e, t, n) {
                    alert(t.statusText)
                }
            })
        }
        function i() {
            $(h).filter(".my-discussion_hide").length ? m.addClass("paginator--show") : m.removeClass("paginator--show")
        }
        function o() {
            peppers.checkMobile.css.isMobile() || (u = e.offset().top,
            l = m.offset().top,
            h && h.length > 0 && h.data("bottom", void 0)),
            a(d)
        }
        function a(t, n) {
            m.removeClass("paginator_no-next paginator_no-prev"),
            h && h.removeClass("my-discussion_hide"),
            g.toggle(!(h && h.length > 0)),
            h && h.length > 0 && (t >= h.length && (t = h.length,
            n = !0),
            peppers.checkMobile.css.isMobile() ? r() : s(t, n),
            i(),
            e.trigger("checkbox:change"))
        }
        function r() {
            if (h) {
                var e = 10 * v;
                e < h.length,
                h.each(function(t) {
                    $(this).toggleClass("my-discussion_hide", t >= e)
                })
            }
        }
        function s(e, t) {
            var n, i = 0, o = $(""), a = d = e;
            if (t)
                for (; a-- > 0; )
                    n = h.eq(a),
                    (i += n.outerHeight()) < l - u && (d = a,
                    o = o.add(n));
            for (a = e; a < h.length; a++)
                n = h.eq(a),
                (i += n.outerHeight()) < l - u && (f = a,
                o = o.add(n));
            console.debug(o),
            o.removeClass("my-discussion_hide"),
            h.not(o).addClass("my-discussion_hide"),
            m.toggleClass("paginator_no-next", f >= h.length - 1),
            m.toggleClass("paginator_no-prev", d <= 0)
        }
        function c() {
            switch ($(this).data("direction")) {
            case "-1":
            case -1:
                d > 0 && (f = d - 1,
                a(d, !0));
                break;
            case "1":
            case 1:
                f < h.length - 1 && a(f + 1)
            }
        }
        var l, u, p, h, d, f, m = e.siblings(".paginator"), g = e.find(".user-panel__placeholder");
        p = t;
        var v = 1;
        m.find(".paginator__button").click(c),
        $(window).on("resize:after", o),
        e.on("click", ".close-button", n),
        h = e.find(".list__item"),
        a(d = 0),
        o()
    }
    $.fn.userPanel = function() {
        new t(this)
    }
}(),
function(e, t) {
    function n(t) {
        function n() {
            p.toggleClass("button_inactive", c.serialize() === l)
        }
        function i() {
            l = c.serialize(),
            p.addClass("button_inactive")
        }
        function o(t) {
            t.preventDefault(),
            e(this).is(".button_inactive") || r(c.serializeArray()).done(function() {
                peppers.modal()
            }).then(function() {
                e(document.documentElement).trigger("resize:after")
            })
        }
        function a(e, i) {
            peppers.modal();
            var o = i.toDataURL("image/jpeg");
            s.val(o),
            t.find(".user-pic__image").css("backgroundImage", "url('" + o + "')"),
            n(),
            t.find(".user-edit__form").submit()
        }
        var r;
        t.find(".upload-image").on("upload-image:crop", a);
        var s = e('[name="userpic"]')
          , c = t.find(".user-edit__form").on("form:submit", o);
        c.find("input, textarea").on("change click keyup", n);
        var l, u = t.find(".user-data"), p = t.find(".button");
        u.on("user-data:change", i),
        i(),
        this.init = function(e) {
            r = e
        }
    }
    e.fn.userEdit = function(t) {
        this.each(function() {
            var i = e(this)
              , o = i.data("user-edit");
            o || i.data("user-edit", o = new n(i)),
            o.init(t)
        })
    }
}(jQuery, window.location),
function(e, t, n) {
    function i(n) {
        function i() {}
        function o(t, n) {
            e("#avatar-input").length ? (e("#avatar-input").val(n.toDataURL("image/jpeg")),
            document.getElementById("avatar-form").submit()) : e(".user-edit .upload-image").trigger(t, n)
        }
        function a(e) {
            var t = x.offset()
              , n = x.outerWidth()
              , i = x.outerHeight()
              , o = s(e, "client")
              , a = t.left + n / 2 - o.x
              , r = t.top + i / 2 - o.y
              , c = Math.sqrt(a * a + r * r);
            v.css("fontSize", Math.max(100, Math.min(v.height(), 2 * c * 370 / 426)))
        }
        function r(e) {
            M && M.css(k = c(e))
        }
        function s(e, t) {
            var n = e.touches && e.touches[0] || e;
            return t = t || "page",
            {
                x: n[t + "X"],
                y: n[t + "Y"]
            }
        }
        function c(e) {
            if (e) {
                var t = s(e);
                t.x -= g.x,
                t.y -= g.y
            } else
                t = {
                    x: 0,
                    y: 0
                };
            return {
                left: y.left + t.x,
                right: y.right - t.x,
                top: y.top + t.y,
                bottom: y.bottom - t.y
            }
        }
        function l(n) {
            f = "scale",
            n.preventDefault(),
            v.on("mousemove touchmove", a),
            e(t).on("mouseup  touchend", u)
        }
        function u(n) {
            v.off("mousemove touchmove", a).off("mousemove touchmove", r),
            e(t).off("mouseup  touchend", u),
            "move" === f && (y = k)
        }
        function p(n) {
            n.isDefaultPrevented() || (f = "move",
            n.preventDefault(),
            g = s(n),
            v.on("mousemove touchmove", r),
            e(t).on("mouseup  touchend", u))
        }
        function h() {
            if (M) {
                x.css("borderWidth", 0);
                var e = function(e, t) {
                    var n = {
                        offset: e.offset(),
                        width: e.width(),
                        height: e.height()
                    }
                      , i = {
                        offset: t.offset(),
                        width: t.width(),
                        height: t.height()
                    };
                    return {
                        x: (n.offset.left - i.offset.left) / i.width,
                        y: (n.offset.top - i.offset.top) / i.height,
                        width: n.width / i.width,
                        height: n.height / i.height
                    }
                }(x, M);
                x.css("borderWidth", Math.abs(m)),
                n.trigger("user-pic-crop:save", e)
            }
        }
        function d() {}
        var f, m = -2e3, g = {}, v = n.find(".user-pic-crop__image"), b = n.find(".hexagon__in2"), w = n.find(".user-pic-crop__title");
        e(".user-pic-crop__dot", v).on("touchstart  mousedown", l),
        e(".user-pic-crop__save", n).on("click", h),
        v.on("touchstart  mousedown", p);
        var y, k, _ = n.find(".select-file").uploadImage().on("upload-image:crop", o), x = n.find(".user-pic-crop__mask-hex").css({
            left: m,
            right: m,
            top: m,
            bottom: m,
            borderWidth: Math.abs(m)
        });
        n.on("modal-item:hide", d),
        e(t).on("hashchange", i);
        var M;
        this.init = function(t, i) {
            if (_.data("title", i),
            w.toggle(!!i),
            i && w.html(i),
            !t)
                return M && M.off().remove(),
                M = void 0,
                !1;
            n.toggleClass("user-pic-crop_edit", !!(t && !0 !== t || M)),
            !0 !== t && (M && M.off().remove(),
            M = t && e(t).appendTo(b).addClass("user-pic-crop__target"),
            y = {
                left: m,
                right: m,
                top: m,
                bottom: m
            },
            r(),
            v.css("fontSize", ""))
        }
    }
    e.fn.userPicCrop = n.jQueryConstructor("user-pic-crop", i)
}(jQuery, window, peppers = peppers || {});
var peppers;
!function(e, t, n) {
    function i(e) {
        this.script = e.find('[type="text/x-handlebars-template"]'),
        this.template = n.compile(this.script.html())
    }
    t.fn.briefCommentsList = e.jQueryConstructor("briefCommentsList", i),
    i.prototype.init = function(e, n) {
        switch (e) {
        case "add":
            console.debug(n);
            var i = t(this.template([n])).find(".brief-comment");
            console.debug(this.$comments, i),
            this.$comments.append(i);
            break;
        default:
            this.$comments && this.$comments.remove(),
            e && (this.$comments = t(this.template(e)).insertAfter(this.script),
            this.$comments.localization("en"))
        }
    }
}(peppers = peppers || {}, jQuery, Handlebars);
var peppers;
!function(e, t, n) {
    function i(e) {
        this.script = e.find('[type="text/x-handlebars-template"]'),
        this.template = n.compile(this.script.html())
    }
    n.registerHelper("ifAuthor", function(e, t, n) {
        return 2 === arguments.length && (n = t),
        e && e.name && e.image ? n.fn(this) : n.inverse(this)
    }),
    t.fn.briefModalContent = e.jQueryConstructor("briefModalContent", i),
    i.prototype.init = function(e) {
        e && (this.ui && this.ui.remove(),
        this.ui = t(this.template(e)).insertAfter(this.script),
        this.ui.find(".user-pic").addClass("user-pic--visible").find(".user-data__userpic").css("background-image", "url('" + (e.author && e.author.image) + "')"))
    }
}(peppers = peppers || {}, jQuery, Handlebars);
var peppers;
!function(e, t, n) {
    function i() {
        var e;
        try {
            e = new ActiveXObject("Msxml2.XMLHTTP")
        } catch (t) {
            try {
                e = new ActiveXObject("Microsoft.XMLHTTP")
            } catch (t) {
                e = !1
            }
        }
        return e || "undefined" == typeof XMLHttpRequest || (e = new XMLHttpRequest),
        e
    }
    function o(e) {
        var t = i();
        t.open("GET", e, !1),
        t.send(null)
    }
    function a() {
        var e = c.is(":checked");
        $(".k-menu .backdrop").toggleClass("backdrop_visible", e),
        s.trigger("menu:" + (e ? "show" : "hide")).trigger("menu:toggle"),
        $(".k-menu").toggleClass("k-menu_visible", e)
    }
    function r() {}
    $(t).on("hashchange", r).on("resize", a);
    var s = $(n.documentElement)
      , c = $("#k-menu-toggle").on("change", a);
    $(".nav-menu__link_lang").on("click", function(e) {
        e.preventDefault(),
        e.stopPropagation(),
        $(this).data("lang") && (o("/backend/api/v1/set/" + $(this).data("lang")),
        parent.php_passed_lang = $(this).data("lang"),
        php_passed_lang = $(this).data("lang"),
        localStorage.language = $(this).data("lang"));
        var n = t.location.hash;
        "#" == n && (n = "");
        var i = "";
        if ("ru" == $(this).data("lang"))
            i = t.location.origin + "/ru" + t.location.pathname + t.location.search + n;
        else {
            if (-1 != location.href.indexOf("/ru#/"))
                var a = "/" + t.location.pathname.split("/ru")[1];
            else
                var a = "/" + t.location.pathname.split("/ru/")[1];
            i = t.location.origin + a + t.location.search + n
        }
        return t.location.replace(i),
        !1
    })
}(peppers = peppers || {}, window, document);
var peppers;
!function(e, t) {
    function n(e) {
        function t(e) {
            return e.replace(/[A-Z]/g, function() {
                return "_" + arguments[0].toLowerCase()
            })
        }
        return function(e) {
            var n = {};
            for (var i in e) {
                for (var o = i.split("_"), a = n, r = t(o[0]), s = 0; s < o.length - 1; s++) {
                    var c = r;
                    r = t(o[s + 1]),
                    a = a[c] = a[c] || (/^\d+$/.test(r) ? [] : {})
                }
                a[r] = e[i]
            }
            return n
        }(e)
    }
    function i(n, i) {
        var a = e(n)
          , r = o(i, a.data("localization"));
        void 0 !== r && (r.hasOwnProperty("attr") && a.attr(r.attr),
        ["string", "number"].indexOf(typeof r) >= 0 ? a.html(r) : r.hasOwnProperty("length") ? a = function() {
            if (a.is("script"))
                var n = a.html();
            else {
                n = "{{#each this}}" + a.get(0).outerHTML + "{{/each}}";
                var i = !0
            }
            var o = t.compile(n)(r);
            a.after(o),
            i && (a.remove(),
            e(o).removeAttr("data-localization"))
        }() : (r.hasOwnProperty("desktop") || r.hasOwnProperty("mobile")) && function() {
            a.html("<span class='mobile-only'>" + r.mobile + "</span><span class='desktop-only'>" + r.desktop + "</span>")
        }())
    }
    function o(e, t) {
        for (var n = t.split("."); e && n.length > 0; )
            e = e[n.shift()];
        return e
    }
    var a, r, s = {}, c = {}, l = [];
    e.fn.localization = function(t, o) {
        function u(e) {
            e.done(p)
        }
        function p(e) {
            r = e,
            d.find("[data-localization]").each(function() {
                l.push(new i(this,e))
            }),
            h.resolve()
        }
        if ("destroy" !== t) {
            t = t || "en";
            var h = e.Deferred()
              , d = this;
            return o && (a = o),
            a || s[t] ? (s[t] = s[t] || a(t, n),
            c[t] && c[t].resolve(s[t]),
            s[t].done(p)) : (c[t] || (c[t] = e.Deferred()),
            c[t].then(u)),
            h.promise()
        }
    }
    ,
    e.fn.localization.getText = function(e, t) {
        if (r)
            return o(r, e)
    }
}(jQuery, window.Handlebars),
function(e, t, n, i) {
    e.fn.welcome = function() {
        function o() {
            c.remove(),
            l.resolve()
        }
        function a(e, n) {
            function i(t) {
                if (!0 === t || !d) {
                    var n = !0 === t ? 0 : p.data("duration") - 0;
                    m.each(r(0, 1, n || 0 === n ? n : s[e] || 1, 0, l))
                }
            }
            function l() {
                a(++e, .2)
            }
            function u() {
                d || (m.each(function() {
                    t.killTweensOf(this)
                }),
                d = !0,
                i(!0))
            }
            var d;
            if (h = u,
            e >= p.length)
                return void c.fadeOut(o);
            var f = p.eq(e).show()
              , m = f.find(".welcome__l");
            n = n || 0,
            m.css("opacity", 0).each(r(1, .5, n, .025, i))
        }
        function r(e, o, a, r, s) {
            var c = 0;
            return function(l) {
                c++,
                t.to(this, o, {
                    opacity: e,
                    delay: a + r * l,
                    ease: n.ease.config({
                        template: i.easeNone,
                        strength: 2,
                        points: 10,
                        taper: "none",
                        randomize: !0,
                        clamp: !0
                    }),
                    onComplete: function() {
                        0 == --c && "function" == typeof s && s()
                    }
                })
            }
        }
        var s = [1, 6, 3]
          , c = this
          , l = e.Deferred()
          , u = peppers.checkMobile.css.isMobile();
        if (0 === this.length || e.cookie("visited") || u)
            o();
        else {
            e.cookie("visited", "1", {
                expires: 3650,
                path: "/"
            });
            var p = this.find(".welcome__text").each(function() {
                var t = e(this).children()
                  , n = t.html();
                n = n.split("").map(function(e) {
                    return "<span  class='welcome__l'>" + e + "</span>"
                }),
                t.html(n.join(""))
            });
            a(0, 1)
        }
        var h;
        return this.on("click", function() {
            h()
        }),
        l.promise()
    }
}(jQuery, TweenLite, RoughEase, Power0),
function(e, t, n, i, o, a, r) {
    function s() {
        t.planetMain && t.planetMain(c("locations"), c("location")),
        o(".hexagonal-map").hexagonalMap(c("location")),
        t.voteApi = c("agree", void 0, !1, "post"),
        t.commentApi = c("comment-add", void 0, !1, "post"),
        t.likeApi = c("work-add_like", void 0, !1, "post"),
        t.sortElement = c("sort", void 0, !1, "post"),
        t.sortArtwork = c("sortArtwork", void 0, !1, "post"),
        o(".js-select").select2({
            minimumResultsForSearch: 1 / 0
        }),
        o(".brief-360").brief(),
        "undefined" != typeof InstallTrigger && o(".close-button-hexagon, .back-btn-svg").hexButton(),
        o(function() {
            function e(e) {
                e = e || ~~o.cookie(n) || i[i.length - 1 >> 1],
                o(".timeline").pepTimeline(i, e).on("timeline:change", function(e, t) {
                    o.cookie(n, t, {
                        path: "/",
                        expires: new Date(3e3,0,1)
                    })
                }).trigger("timeline:init")
            }
            var n = "selectedYear"
              , i = [2030, 2040, 2050];
            t.artwork ? e(t.artwork.year) : e()
        }),
        h.resolve(),
        d.trigger("hashchange"),
        f.trigger("hashchange").resize(),
        t.ready.done(function() {
            u(),
            o(n).trigger("hashchange").resize()
        })
    }
    function c(e, t, i, a, r) {
        function s(t, n, i) {
            return o.get("api_example/" + e + ".json")
        }
        function c(e) {
            var t = o.cookie("test_api");
            if ("1" === t)
                return !0;
            try {
                for (var n = JSON.parse(t), i = 0; i < n.length; i++)
                    if (n[i].name === e)
                        return "1" == n[i].value
            } catch (e) {}
            return !1
        }
        function l(e, t, n, i) {
            i = i || !1,
            r = void 0 === r || Boolean(r);
            var a = {
                method: n || "GET",
                async: r
            };
            if (i) {
                var s = new FormData;
                for (key in t)
                    t.hasOwnProperty(key) && s.append(key, t[key]);
                a.processData = !1,
                a.contentType = !1,
                a.cache = !1,
                a.data = s
            } else
                a.data = t;
            var c = o.ajax(e, a);
            return c.then(function(e) {
                return e._token && o.ajaxSetup({
                    headers: {
                        "X-CSRF-TOKEN": e._token
                    }
                }),
                e
            }),
            c
        }
        function u() {
            d.hasOwnProperty(e) && d[e]()
        }
        function p() {
            var e = arguments;
            return function() {
                "function" == typeof ga && ga.apply(n, e)
            }
        }
        var h, d = {
            agree: p("send", "event", "Button1", "Click2"),
            "work-add_like": p("send", "event", "Button2", "Click")
        }, f = {
            location: "locations/{location_id}",
            locations: "locations",
            "comment-add": "predictions/{brief_id}/comment",
            works: "predictions/{brief_id}/works",
            agree: "predictions/{brief_id}/vote/{agree}",
            "work-add_like": "artworks/{artwork_id}/like",
            sort: "predictions/{sort}/{type}",
            sortArtwork: "artworks/{sort}/{type}"
        }, m = l, g = "work-save" == e;
        return h = langUrl + "api/" + (f.hasOwnProperty(e) ? f[e] : ""),
        function(n, r, l) {
            function p(e, t) {
                for (var n in e)
                    if (e.hasOwnProperty(n))
                        if (t || /^(?:image|photo|preview|flag|url)s?$/.test(n))
                            switch (typeof e[n]) {
                            case "string":
                                /^backend\//.test(e[n]) && (e[n] = "/" + e[n]);
                                break;
                            case "object":
                                p(e[n], !0)
                            }
                        else
                            "object" == typeof e[n] && p(e[n]);
                return e
            }
            function d(e) {
                switch (!0) {
                case "string" == typeof e:
                    k.reject(e);
                    break;
                case !1 === e.success:
                    var t = e.text || e.message || e.error;
                    k.reject(t);
                    break;
                case e.hasOwnProperty("error"):
                    k.reject(e.text || e.error);
                    break;
                case e.hasOwnProperty("errors"):
                    var n = [];
                    for (var i in e.errors)
                        n.push(e.errors[i].join(", "));
                    k.reject(n.join("<br>"));
                    break;
                case e[0] && !1 === e[0].success:
                    k.reject(e[0].message);
                    break;
                default:
                    u(),
                    k.resolve(e)
                }
            }
            var b = h;
            if ("localization" === e && (n = void 0),
            v.hasOwnProperty(b))
                return v[b];
            n && f[e] && (b = b.replace(/\/\{([^\}]+)\}/g, function() {
                var e = arguments[1];
                if (n.hasOwnProperty(e)) {
                    var t = n[e];
                    return delete n[e],
                    t ? "/" + t : ""
                }
                return ""
            }));
            var w;
            switch (typeof n) {
            case "object":
                for (var y in n)
                    if (n.hasOwnProperty(y)) {
                        w = n;
                        break
                    }
                break;
            default:
                w = n
            }
            var k = o.Deferred()
              , _ = k.promise();
            return (c(e) ? s : m)(b, w, l || a || (w ? "post" : "get"), g).then(function(t) {
                return "localization" !== e ? p(t) : t
            }).then(t).then(r).done(function(e) {
                d(e)
            }).fail(function(e) {
                e.responseJSON ? d(e.responseJSON) : k.reject(e.message || e.responseText || "ERROR")
            }),
            !0 === i && (v[h] = _,
            _.fail(function() {
                delete v[h]
            })),
            _
        }
    }
    function l() {
        function t() {
            o.cookie("visited-2", "1", {
                expires: 3650,
                path: "/"
            }),
            o(this).off("mousedown  touchstart", t),
            o(".help").fadeOut()
        }
        if (e.checkMobile.css.isMobile())
            return void o.cookie("visited-2", "1", {
                expires: 3650,
                path: "/"
            });
        if (!o.cookie("visited-2")) {
            o(".help").fadeIn().parent().on("mousedown  touchstart", t)
        }
    }
    function u() {
        o(".welcome").welcome().done(l)
    }
    function p(e) {
        return e && e.replace(/^\s+|\s+$/g, "")
    }
    var h = t.ready.addWait()
      , d = o(i)
      , f = o(n)
      , m = o(i.documentElement)
      , g = o(i.body)
      , v = {};
    !function() {
        !function() {
            r.registerHelper("switch", function(e, t) {
                this._switch_value_ = e;
                var n = p(t.fn(this));
                return delete this._switch_value_,
                n
            }),
            r.registerHelper("case", function(e, t) {
                return e == this._switch_value_ ? t.fn(this) : ""
            })
        }(),
        function() {
            r.registerHelper("brief_link", function(e, t) {
                return this.brief_id || this.brief && this.brief.id || this.id
            })
        }(),
        function() {
            r.registerHelper("user_link", function(e, t) {
                return "user-panel.html?user_id=" + this.id
            })
        }(),
        function() {
            r.registerHelper("json", function(e, t) {
                return "<pre>" + JSON.stringify(e, null, "\t") + "</pre>"
            })
        }(),
        function() {
            r.registerHelper("ifCond", function(e, t, n) {
                return e === t ? n.fn(this) : n.inverse(this)
            })
        }(),
        function() {
            r.registerHelper("isSingle", function(e) {
                return 1 !== e ? "" : "_single"
            })
        }(),
        function() {
            r.registerHelper("howMuch", function(e) {
                var t;
                t = 2 == e.toString().length && 1 == e.toString().substr(-2, 1) ? 5 : e.toString().substr(-1),
                t = t.toString();
                var n;
                switch (t) {
                case "1":
                    n = "_quant1";
                    break;
                case "2":
                case "3":
                case "4":
                    n = "_quant2";
                    break;
                case "5":
                case "6":
                case "7":
                case "8":
                case "9":
                case "0":
                default:
                    n = "_quant5"
                }
                return n
            })
        }()
    }(),
    function() {
        o.fn.blink = function() {
            this.children().not(".login__form").add(this.find(".login__form > *")).css({
                opacity: 0
            }).each(function(e) {
                TweenLite.to(this, .5, {
                    opacity: 1,
                    delay: .5 + .5 * Math.random(),
                    ease: RoughEase.ease.config({
                        template: Power0.easeNone,
                        strength: 2,
                        points: 20 + 20 * Math.random(),
                        taper: "none",
                        randomize: !0,
                        clamp: !0
                    })
                })
            })
        }
    }(),
    function() {
        t.get_metadata = function() {
            return {
                title: o("title").html(),
                description: o('meta[name="description"]').attr("content"),
                og_title: o('meta[property="og:title"]').attr("content"),
                og_description: o('meta[property="og:description"]').attr("content"),
                og_image: o('meta[property="og:image"]').attr("content"),
                og_url: o('meta[property="og:url"]').attr("content")
            }
        }
        ,
        t.set_metadata = function(e) {
            o("title").html(e.title),
            o('meta[name="description"]').attr("content", e.description),
            o('meta[property="og:title"]').attr("content", e.og_title),
            o('meta[property="og:description"]').attr("content", e.og_description),
            o('meta[property="og:image"]').attr("content", e.og_image),
            o('meta[property="og:url"]').attr("content", e.og_url)
        }
        ,
        t.brief_page_link = function(e) {
            return e.id
        }
        ,
        t.addwork_link = function(e, t) {
            var n = [];
            return e && n.push("brief_id=" + e),
            t && n.push("work_id=" + t),
            "addwork.html?" + n.join("&")
        }
        ,
        t.user_link = function(e) {
            return "user-panel.html" + (e ? "?user_id=" + e : "")
        }
        ,
        t.mapToHash = function(e) {
            for (var t = {}, n = 0; e && n < e.length; n++)
                t[e[n].name] = e[n].value;
            return t
        }
        ,
        t.parseURL = function(e) {
            function n(e) {
                var t = e.split("=");
                return {
                    name: t.shift(),
                    value: t.join("=")
                }
            }
            var i = a.search.substr(1)
              , o = i.split("&");
            if (0 == arguments.length)
                return o.map(n);
            if (!0 === e)
                return t.mapToHash(o.map(n));
            for (var r = 0; r < o.length; r++) {
                var s = n(o[r]);
                if (s.name === e)
                    return s.value
            }
        }
    }(),
    function() {
        function e(e, t) {
            var n = e.data("scrollTop");
            t ? (void 0 === n && (n = m.scrollTop()),
            e.css({
                top: -n,
                position: "fixed",
                width: "100%"
            })) : (e.css({
                top: "",
                position: "",
                width: ""
            }),
            "number" == typeof n && m.scrollTop(n),
            e.data("scrollTop", void 0))
        }
        m.on("modal:toggle  menu:toggle  best-of-week:toggle", function(t) {
            var n = o(".backdrop").is(":visible");
            e(o(".kaspersky-app"), n);
            var i = o(".modal .backdrop").is(":visible")
              , a = o(".k-menu .backdrop").is(":visible");
            e(o(".modal"), a),
            e(o(".modal-app"), a),
            e(o(".best-of-week"), a || i)
        })
    }(),
    function() {
        function t() {
            requestAnimationFrame(n)
        }
        function n() {
            function t(e, t) {
                o("[" + e + "]").each(function() {
                    var n = o(this);
                    n.toggleClass(n.attr(e), t)
                })
            }
            var n = f.width()
              , i = f.height()
              , r = "boolean" == typeof a ? !a : e.checkMobile.css.isLandscape();
            g.is(".is_vr") && (r = !r);
            var s = e.checkMobile.css.isMobile()
              , c = {};
            switch (!0) {
            case r:
                c = {
                    w: 1135,
                    h: 640
                };
                break;
            case s:
            case e.checkMobile.isMobileOrTablet():
                c = {
                    w: 640,
                    h: 1135
                };
                break;
            default:
                c = {
                    w: 1280,
                    h: 720
                }
            }
            m.css("fontSize", 18 * Math.min(1, n / c.w)),
            m.toggleClass("landscape", r);
            var l = {
                width: n,
                height: i
            };
            m.data("size", l).trigger("resize:after", l),
            t("data-mobile-class", s),
            t("data-desktop-class", !s)
        }
        f.resize(t),
        o(i.body).on("vr:change", n);
        var a
    }(),
    d.ready(s)
}(peppers = peppers || {}, kaspersky = kaspersky || {}, window, document, jQuery, window.location, Handlebars);
var kaspersky, peppers;
document.addEventListener("DOMContentLoaded", function(e) {
    function t(e, t, n) {
        n = n || {};
        var i = n.expires;
        if ("number" == typeof i && i) {
            var o = new Date;
            o.setDate(o.getDate() + i),
            i = n.expires = o
        }
        i && i.toUTCString && (n.expires = i.toUTCString()),
        t = encodeURIComponent(t);
        var a = e + "=" + t;
        for (var r in n) {
            a += "; " + r;
            var s = n[r];
            !0 !== s && (a += "=" + s)
        }
        document.cookie = a
    }
    var n = {
        text: 'We use cookies to make your experience of our websites better. By using and further navigating this website you accept that some of your browsing activity can be recorded in cookies. Detailed information about the use of cookies on this website is available by clicking on <a href="https://www.kaspersky.com/web-privacy-policy" target="_blank">more information</a>. ',
        button: "Accept "
    };
    if ("ru" === localStorage.language)
        var n = {
            text: '   cookie,    .    ,  ,            cookie.      cookie         <a href="https://www.kaspersky.ru/web-privacy-policy" target="_blank"> </a>. ',
            button: " "
        };
    var i = function(e) {
        var t = document.cookie.match(new RegExp("(?:^|; )" + e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, "\\$1") + "=([^;]*)"));
        return t ? decodeURIComponent(t[1]) : void 0
    }("cookie_accepted");
    if (navigator.cookieEnabled && !i) {
        var o = '<div class="gdprPopup"><div class="gdprPopupContainer"><div class="gdprMessage">' + n.text + '</div><p class="gdprButton">' + n.button + "</div></div></div>";
        document.querySelector("body").insertAdjacentHTML("beforeEnd", o),
        document.querySelector(".gdprButton").onclick = function() {
            e.preventDefault(),
            t("cookie_accepted", !0, {
                expires: 30
            }),
            document.querySelector(".gdprPopup").remove()
        }
        ,
        document.querySelector("*").setAttribute("style", "box-sizing : border-box;"),
        document.querySelector(".gdprPopup").setAttribute("style", "border : 1px solid black; background : rgba(0,0,0,.8); color : white; font-family : MuseoSans,Arial,Helvetica,sans-serif; font-size : 16px; position : fixed; left : 0; bottom : 0; width : 100%; z-index : 1500; font-size : .8em; padding-bottom : .5em; padding-top : 1em;"),
        document.querySelector(".gdprPopupContainer").setAttribute("style", "width : 90%; max-width : 1030px; margin-left : auto; margin-right : auto;"),
        document.querySelector(".gdprPopupContainer a").setAttribute("style", "color : white;text-decoration: underline!important;"),
        document.querySelector(".gdprMessage").setAttribute("style", "width : 80%; float : left; margin-bottom : .5em; padding-bottom : .5em;"),
        document.querySelector(".gdprButton").setAttribute("style", "cursor:pointer;position : relative; float : right; margin-right : -15px; width : auto; text-decoration : none; background-color : #006D5C; text-decoration : none; padding : 1.083em 1.5em; min-width : 12em; color : #FFF; font-size : .75em; border-radius : 1px; text-transform : uppercase; right : 0; top : 4px; margin-bottom : 10px;   text-align:center;transition : all .15s ease-in;box-sizing: border-box;"),
        document.querySelector(".gdprButton").onmouseover = function() {
            this.style.background = "#005446"
        }
        ,
        document.querySelector(".gdprButton").onmouseout = function() {
            this.style.background = "#006D5C"
        }
        ,
        window.onresize = function() {
            window.innerWidth < 655 ? (document.querySelector(".gdprMessage").style.width = "100%",
            document.querySelector(".gdprButton").style.marginRight = "0",
            document.querySelector(".gdprButton").style.width = "100%") : (document.querySelector(".gdprMessage").style.width = "80%",
            document.querySelector(".gdprMessage").style.cssFloat = "left",
            document.querySelector(".gdprButton").style.marginRight = "-15px",
            document.querySelector(".gdprButton").style.width = "auto")
        }
    }
});
